
test_that("estimation cdf_rank", {
  expect_equal(
   bbwp_field_properties(
      B_SOILTYPE_AGR = 'dekzand',
      B_LU_BRP = 265,
      B_GWL_CLASS = 'GtIII',
      B_SC_WENR = 4, 
      B_HELP_WENR = 'AZW1AwF',
      A_CLAY_MI = 15,
      A_SAND_MI = 45,
      A_SILT_MI = 40,
      A_SOM_LOI = 5, 
      A_N_RT = 4200,
      A_FE_OX = 500, 
      A_AL_OX = 150, 
      A_P_CC = 5, 
      A_P_AL = 65,
      A_P_WA = 52, 
      A_P_SG = 38,
      D_WP = 0.5, 
      D_RO_R = 0.5,
      LSW = data.table(
        sd_wp = 0.27,
        mean_wp = 0.33,
        sd_n_rt = 371.4,
        sd_p_al = 10.6,
        sd_p_cc = 1.34,
        sd_p_sg = 7.92,
        sd_p_wa = 12.5,
        sd_ro_r = 0.305,
        sd_al_ox = 3.99,
        sd_fe_ox = 6.25,
        mean_n_rt = 1599.9,
        mean_p_al=  63.2,
        mean_p_cc =3.27,
        mean_p_sg = 59.5,
        mean_p_wa = 56.781,
        mean_ro_r = 0.471,
        mean_al_ox = 36.401,
        mean_fe_ox = 27.877,
        sd_clay_mi = 0.583,
        sd_sand_mi = 5.93,
        sd_silt_mi = 4.158,
        sd_som_loi = 0.799,
        mean_clay_mi = 2.00,
        mean_sand_mi = 83.96,
        mean_silt_mi = 12.81,
        mean_som_loi = 3.92
      )
    ),
    expected = data.table(
      ngw_scr = 0.4,
      ngw_lea = 0.2649,
      ngw_nlv = 1,
      nsw_scr = 0.6,
      nsw_gwt = 0.8,
      nsw_ro = 0.5379,
      nsw_ws = 0.7356,
      nsw_nlv = 0.5,
      psw_scr = 0.6,
      psw_gwt = 0.8,
      psw_ro = 0.5378,
      psw_ws = 0.7356,
      psw_pcc = 0.9017,
      psw_psg = 0.0033,
      psw_pret = 0,
      npe_wri = 0.095,
      npe_pbi = 0.976,
      npe_wdri = 0,
      npe_nlv = 0.5,
      wue_wwri = 0.095,
      wue_wdri = 0,
      wue_whc = 0.2338
    ),
    tolerance = 0.01)
})

