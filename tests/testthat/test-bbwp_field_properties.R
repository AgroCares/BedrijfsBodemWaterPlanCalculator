
LSW = data.table(sd_wp = rep(0.27, 2),
                  mean_wp = 0.33,
                  sd_n_rt = 371.4,
                  sd_p_al = 10.6,
                  sd_p_cc = 1.34,
                  sd_p_sg = 7.92,
                  sd_p_wa = 12.5,
                  sd_ro_r = 0.305,
                  sd_al_ox = 3.99,
                  sd_fe_ox = 6.25,
                  mean_n_rt = 1599.9,
                  mean_p_al=  63.2,
                  mean_p_cc =3.27,
                  mean_p_sg = 59.5,
                  mean_p_wa = 56.781,
                  mean_ro_r = 0.471,
                  mean_al_ox = 36.401,
                  mean_fe_ox = 27.877,
                  sd_clay_mi = 0.583,
                  sd_sand_mi = 5.93,
                  sd_silt_mi = 4.158,
                  sd_som_loi = 0.799,
                  mean_clay_mi = 2.00,
                  mean_sand_mi = 83.96,
                  mean_silt_mi = 12.81,
                  mean_som_loi = 3.92
                )
test <- bbwp_field_properties(B_SOILTYPE_AGR = c('dekzand', 'loess'),
                              B_LU_BRP = c(265, 1932),
                              B_GWL_CLASS = c('GtIII', '-'),
                              B_SC_WENR = c(4, 2), 
                              B_HELP_WENR = c('AZW1AwF', 'AZW1AwF'),
                              B_SLOPE_DEGREE = c(1.5,0.8),
                              A_CLAY_MI = c(15, 5),
                              A_SAND_MI = c(45, 65),
                              A_SILT_MI = c(40, 30),
                              A_SOM_LOI = c(5, 15), 
                              A_N_RT = c(4200, 1000),
                              A_FE_OX = c(500, 500), 
                              A_AL_OX = c(150, 150), 
                              A_P_CC = c(5, 1), 
                              A_P_AL = c(65, 5),
                              A_P_WA = c(52, 5), 
                              A_P_SG = c(38, 78),
                              D_WP = c(0.5, 1), 
                              D_RO_R = c(0.5, 0),
                              LSW = LSW
                            )

test_that("check bbwp_field_properties", {
  expect_equal(
   object = test,
    expected = data.table(
      ngw_scr = c(0.4, 0.8),
      ngw_lea = c(0.2649, 0.4274),
      ngw_nlv = c(1, 0.0531),
      nsw_scr = c(0.6, 0.2),
      nsw_gwt = c(0.8, 1),
      nsw_ro = c(0.5379, 0.061),
      nsw_slope = c(0.75,0.4),
      nsw_ws = c(0.7356, 0.993),
      nsw_nlv = c(0.5, 0.0531),
      psw_scr = c(0.6, 0.2),
      psw_gwt = c(0.8, 1),
      psw_ro = c(0.5378, 0.061),
      psw_slope = c(0.75,0.4),
      psw_ws = c(0.7356, 0.993),
      psw_pcc = c(0.9017, 0.045),
      psw_psg = c(0.0033, 0.990),
      psw_pret = c(0, 0),
      npe_wri = c(0.095, 0),
      npe_pbi = c(0.976, 0.0216),
      npe_wdri = c(0, 0),
      npe_nlv = c(0.5, 0.946),
      wue_wwri = c(0.095, 0),
      wue_wdri = c(0, 0),
      wue_whc = c(0.2338, 0.055)
    ),
    tolerance = 0.01)
})

